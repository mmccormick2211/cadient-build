{
    "description": "Base install of Windows 2016 Standard (1607)",
    "min_packer_version": "",
    "variables": {
        "build_timestamp": "{{isotime \"20060102-1504\"}}",
        "mirror": "https://software-download.microsoft.com",
        "mirror_directory": "download/pr",
        "iso_name": "Windows_Server_2016_Datacenter_EVAL_en-us_14393_refresh.ISO",
        "iso_checksum": "772700802951b36c8cb26a61c040b9a8dc3816a3",
        "iso_checksum_type": "sha1",
        "box_basename": "win2016",
        "template": "{{user `box_basename`}}-std-base",
        "vm_name": "packer-{{user `template`}}-vmware",
        "guest_os_type": "windows9srv-64",
        "headless": "false",
        "cpus": "2",
        "memory": "4096",
        "disk_size": "32767",
        "packer_output": "D:/PACKER_BUILDS",
        "vagrant_output": "D:/VAGRANT_BOXES"
    },
    "builders": [{
        "type": "null",
        "communicator": "winrm",
        "winrm_host": "192.168.190.150",
        "winrm_username": "vagrant",
        "winrm_password": "vagrant",
        "winrm_timeout": "12h",
        "shutdown_command": "shutdown /s /t 10 /f /d p:4:1 /c \"Packer Shutdown\"",
        "shutdown_timeout": "15m"
    }],
    "provisioners": [{
            "type": "breakpoint",
            "note": "foo bar baz",
            "disable": "false"
        },
        {
            "type": "powershell",
            "elevated_user": "vagrant",
            "elevated_password": "vagrant",
            "valid_exit_codes": [
                0,
                1605,
                1614,
                1641,
                3010
            ],
            "inline": [
                "##### 2019-07 Servicing Stack Update for Windows Server 2016 for x64-based Systems (KB4509091)",
                "##### or latest Servicing Stack for OS",
                "#",
                "#ABC-Update.exe /A:Install /S:WSUS=http://sys-wsus-app1.corp.unicru.com /R:N /K:KB4509091",
                "#ABC-Update.exe /A:Install /S:MSUpdate /R:N /K:KB4509091",
                "ABC-Update.exe /A:Install /S:MSUpdate /R:N /N:*Servicing Stack Update*",
                "#"
            ]
        },
        {
            "type": "windows-restart",
            "timeout": "20m"
        },
        {
            "type": "breakpoint",
            "note": "foo bar baz",
            "disable": "false"
        }
    ],
    "post-processors": [{
        "type": "vagrant",
        "output": "{{user `vagrant_output`}}/test-{{user `vm_name`}}.box"
    }]
}